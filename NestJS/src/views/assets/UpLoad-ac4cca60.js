import{n as a}from"./index-a1f01123.js";const i={name:"OpenImages",props:["url","classStyle"],data(){return{srcList:[]}},mounted(){},methods:{}};var r=function(){var e=this,t=e._self._c;return t("div",[t("el-image",{style:e.classStyle,attrs:{src:e.$getFiles(e.url).split(",")[0],"preview-src-list":e.$getFiles(e.url).split(","),lazy:""}})],1)},o=[],n=a(i,r,o,!1,null,"17481185",null,null);const _=n.exports;const p={props:["value","limit","listType","message","folder","form"],data(){return{dialogUploadImage:!1,uploadList:[],srcList:[]}},async mounted(){await this.getFullPath(this.value)},methods:{getFullPath(s){this.uploadList=s?s.split(",").map(e=>({response:`${e}`,url:`${this.$getFiles(`${e}?token=${this.$getToken()}`)}`})):[]},async onUpLoadFile(s){if(!this.form.folderId){this.$message.error("请先选择文件夹"),this.value=null;return}let e=new FormData;e.append("file",s.file),e.append("folderId",this.form.folderId);let t=await this.$request.post("/file",e);this.$message.success("上传成功"),this.$emit("input",this.value?this.value+","+t:t)},handlePictureCardPreview(s){this.dialogUploadImage=!0},handleUploadSuccess(s){this.$emit("input",this.value?this.value+","+s:s)},beforeAvatarUpload(s){const e=s.type.startsWith("image/"),t=s.size/1024/1024<300;return e||this.$message.error("上传的文件必须是图片格式!"),t||this.$message.error("上传的图片大小不能超过 300MB!"),e&&t},handleRemove(s){let e=this.uploadList.filter(t=>t.response!==s.response).map(t=>t.response).join(",");this.$emit("input",e)}},watch:{value(s){this.getFullPath(s)}}};var d=function(){var e=this,t=e._self._c;return t("div",[t("el-upload",{ref:"upload",attrs:{action:"",multiple:"",limit:e.limit||1,"file-list":e.uploadList,"http-request":e.onUpLoadFile,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"list-type":e.listType||"picture-card","before-upload":e.beforeAvatarUpload}},[t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("el-dialog",{attrs:{visible:e.dialogUploadImage,"append-to-body":!0},on:{"update:visible":function(l){e.dialogUploadImage=l}}},[t("el-image",{staticStyle:{width:"100%"},attrs:{src:`${e.$getFiles(e.value)}?token=${e.$getToken()}`,"preview-src-list":[`${e.$getFiles(e.value)}?token=${e.$getToken()}`]}})],1),t("div",{staticClass:"color_danger",staticStyle:{"font-size":"75%"}},[e._v(" "+e._s(e.message!=null?e.message:`最多上传${e.limit}张图片`)+" ")])],1)},u=[],c=a(p,d,u,!1,null,"eaa2fe0f",null,null);const f=c.exports;export{_ as O,f as U};
